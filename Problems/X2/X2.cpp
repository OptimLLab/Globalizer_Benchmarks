#include "X2.h"

#define _USE_MATH_DEFINES
#include <math.h>

/*
// простые почти линейные функции
double X_magic[] = { 0.623386736514169, 0.2635806707264857, -0.8559800867743914, 0.041031537438733785, 0.6559519115660516, 0.1259971482136789, -0.6065079311987236, 0.014967250391907046, -0.7351947323119925, 0.10563864197283587, 0.7123181732675311, 0.16761029953075263, 0.7687163050997563, 0.2389688616423427, -0.634318964062702, 0.21687008916946532, 0.7839558677430416, 0.14173738923690868, 0.9161798896260188, 0.07106484740593062, 0.6235217341426209, 0.17617564166058877, -0.6409407633006814, 0.03628463199165917, 0.8134248533507814, 0.20259908821802106, 0.985482855624524, 0.27047369351626566, -0.8848254167825872, 0.22694949960769037, -0.9480035140917568, 0.19031033227567506, -0.5893412292483563, 0.18937713529566944, 0.5684255802744099, 0.05052620398452209, 0.6999231314654664, 0.26038971159711416, 0.938776908831606, 0.21117942073012425, 0.8849683609533825, 0.1121769822076208, 0.8914860963036868, 0.1787192440098622, 0.8938014867593647, 0.21658242619538012, 0.5608439796347295, 0.20343619853445258, 0.5094418704705101, 0.1348977324883231, -0.6251403208084282, 0.22180268435898226, -0.7255509482367839, 0.038385393515470344, -0.9795641838875847, 0.15903136637978288,
0.5387868752057206, 0.26586924825567676, 0.9006847278397452, 0.29957835104823727, 0.9622568815734429, 0.24182074321555466, -0.6636075418405711, 0.054530847013955226, 0.5896556504097434, 0.04218545766374076, 0.8067967301385208, 0.17995074999726676, 0.8473110245198597, 0.1491476197904247, 0.8552790279558107, 0.2487045037671295, -0.7842992624435235, 0.1779043723056879, -0.9553393954376538, 0.015169627932416746, 0.7487552778122322, 0.27530014905917566, -0.9496934491774283, 0.016068443976194106, -0.5141728994594621, 0.1145870702745728, 0.65563413876716, 0.24336806235230915, -0.5555276225032795, 0.010766376161056855, -0.8270959929417012, 0.14322866060620604, 0.7886126093920216, 0.15282478831597443, -0.5507074643891778, 0.02233275615702208, -0.7536374341035665, 0.22134973325849572, 0.6900566149253735, 0.10635127964794326, -0.7969765372733362, 0.0536997294748879, -0.5115938528943973, 0.049609650710170546, 0.6788601195317046, 0.1391143927168816, -0.8645604418842026, 0.12281839749768618, -0.9856319228696281, 0.08770083493444229, -0.9828957917685871, 0.017750781265920463, -0.9894429488094159, 0.07976300432214474, 0.60291313096225, 0.24261998595208922, 0.5981352502250947, 0.10396183950873382, 0.7396819316687484, 0.27697404067445824, 0.7866494121423979, 0.19862975500113036, 0.6783131593966563, 0.2937802541535134, 0.7317520907493494, 0.15584535436943744, -0.6327483735043096, 0.12953423609190762, -0.5984487340309694, 0.1032047778369338, -0.7825879259938402, 0.24307427337488977, -0.7211362030731889, 0.018143515361266994, -0.6057627939405318,
0.062319883633935244, -0.517211449549525, 0.2389193756744507, -0.7871255284028611, 0.2543488579997543, -0.6046453141748438, 0.0518973237601304, -0.8952364404831763, 0.26580761085600035, -0.8319987280675679, 0.07207489930264703, 0.6119414621300254, 0.26155054147580487, 0.8434974675198725, 0.1608358348959911, -0.9139554274406785, 0.03691284877865266, -0.7410264652448759, 0.20989325169715098, 0.9232286385474324, 0.09732525706395191, 0.8428217075378968, 0.23930982802070735, -0.8562174944175632, 0.19430889119032954, -0.5313782643196356, 0.20057857095057308, 0.789034419449612, 0.09494628063311225, 0.54602020176445, 0.06710099647646704, 0.9839661694955066, 0.21811890118906718, 0.6735988699514672, 0.027213115868044604, -0.9135277612010773, 0.022232909757657952, 0.8650271870753581, 0.16491676605329644, -0.69486999564761, 0.06734307871258544, 0.5323998258608514, 0.23095215860224413, -0.8989563171949979, 0.2795467397316256, 0.7105827054846814, 0.02161016441962846, 0.7070669110505057, 0.19814386394553768, -0.6747250677094041, 0.21144305035274205, -0.7882130061366567, 0.19095155356233304, 0.9409482802021463, 0.22526463715624648, -0.5680582365252058, 0.2462212253161056, 0.6087507748266853, 0.12056122985384579, 0.9695414985095623, 0.1698370303067522, -0.5395176665431004, 0.042420816384563645, -0.590599123980571, 0.13609603763274256, -0.826289312493348, 0.2594139458991803, -0.7844749216683005, 0.2082457645842515, 0.9843384365431183, 0.2192519092610458, 0.8568962949437136, 0.19260695212839077, -0.8042173311476896, 0.09896683581167647, 0.8856857538225562, 0.024602711121240614, 0.8937103508406334, 0.1366929031561691, -0.5644386215526305, 0.019079991052239124, -0.5045292611852075, 0.1382642869085318, 0.913015535548737, 0.2518519253396131, 0.7263648477025808, 0.2508899816943289, -0.7294673826120803, 0.22841317276658404, -0.9265429653495217, 0.050504268486822775, 0.9472418928208912, 0.22896599026557274, -0.6746835561181348, 0.035037448239975066, 0.9965193932488776, 0.059656958825470036, 0.9870144085987131, 0.11626618029137427, 0.9565493042187008, 0.25292664072226745, 0.698779541250621, 0.16211286980535622, 0.856050429401628, 0.2616441535883279, 0.6396976573944704, 0.10195054876060428, 0.5431940089445662, 0.2152674790959953, 0.5845544338898787, 0.0649126451505167, -0.5112674586137403, 0.26355576606566844, -0.7127992143365676, 0.12122760716943198, -0.7725802791395369, 0.163742572765756, 0.5957127188625433, 0.13089066112151637, 0.9097830474664363, 0.144203084781395, -0.5449775989140417, 0.027200002968124366, 0.5218921877765115, 0.09215230569840746, 0.7659358748792473, 0.0968988037204506, 0.9173385582309013, 0.19283213721806214, -0.9968162502565363, 0.2250703534305209, -0.5938808823412327, 0.2517867240249464, -0.7028144153926839, 0.10449584196969995, -0.6401320123846412, 0.28756973857109275, 0.8328179895697672, 0.17481941169096107, 0.634325233557464, 0.035993985843266865, 0.7219298082168416, 0.061834408275502656, 0.6758302279088191, 0.03024706494325178, -0.7874612676367807, 0.040561336134639116, 0.8903921808597681, 0.2898072237073112, -0.5956301358002527, 0.27998506565241643, 0.6444701708980376, 0.0503283082737495, 0.9388751289413236, 0.22454301820377265, 0.9918592790182241, 0.2099280855552548, 0.5765750616602012, 0.2924429877202459, 0.5164823421074871, 0.22796859230096986, 0.9977765808880883, 0.08504985046821202, 0.9263841309920172, 0.20085361927206635, -0.6058855276443795, 0.20460395235234263, -0.9178960536108894, 0.11169187294382375, -0.6885400345874713, 0.2883580159214801, -0.6827983149374761, 0.04614082016775696, -0.7432782654756056, 0.1374814029428033, -0.7607932055039799, 0.26624141509461474, 0.5237252063629181, 0.24042433935394578, -0.5260676938425722, 0.053481684562727366, -0.7717164117893964, 0.21343512993913985, 0.8541266949384025, 0.2665756797352606, 0.9254643727241305, 0.20739358569438313, -0.6650189123300226, 0.017422682550727504, -0.5380647331746216, 0.04806694681779705, 0.7818600150280902, 0.0809412446549657, -0.713211937120698, 0.10782882400376051, 0.7171091147474649, 0.21418789626196602, 0.5388430729328291, 0.26280587482347556, 0.5336188771136249, 0.26403097993203095, 0.7351372114305463, 0.29299845360742055, 0.6653357060469626, 0.23492179955606302, 0.8304613330289796, 0.144444335221649, -0.647087034664128, 0.15585418989470845, -0.6924835501019948, 0.21400260170893964, -0.5724275648124808, 0.1188319013093773, -0.7170160867476665, 0.13255689882840624, 0.6621815481788909, 0.1448738977322945, 0.5863196052014656, 0.1694172915069489, -0.5697772731997364, 0.1936837457789487, 0.9001384265006775, 0.15183244784907418, 0.7104744300976995, 0.18289712201961825, -0.8651161144408925, 0.16909300139598687, 0.5482425020996243, 0.12068446298075165, -0.7139187341396598, 0.16332502566427987, -0.751986735856776, 0.15614727409787704, 0.6338503362166972, 0.1277092316436492, 0.6968191915368438, 0.1554860342155461, 0.599649051879477, 0.15767260927956767, 0.5333841329860896, 0.17859217103426492, -0.7935483209495329, 0.1486563239728779, 0.7834798387132702, 0.08270897767988379, 0.7180512053464674, 0.11184973356291136, -0.7432871192757522, 0.057309853089602784, -0.7181085201298503, 0.11211203039271758, -0.665633873087727, 0.12846705168333913, 0.5917444041846635, 0.2740711562524972, -0.7192583371509451, 0.22906254434195844, 0.9568724858955571, 0.23927412063940362, 0.8073514519228671, 0.160382314187025, 0.6760471806541655, 0.013714614634877527, -0.8472533382127686, 0.020345396734782552, 0.7207471307422021, 0.22507815487045368, 0.9567208778798089, 0.16581740496033673, 0.580304443758221, 0.039942633672749486, -0.6734666960829545, 0.15013627998739873, 0.6362640235902266, 0.10252814525658747, -0.6385836236764073, 0.2629842158642731, -0.5820590942650489, 0.09580880845216806, -0.6020269002160084, 0.22620241363759835, -0.5536035637329699, 0.1030545994882477, -0.9535277153548016, 0.05817662735526373, 0.5831443504530627, 0.288370739015057, -0.9742209726063065, 0.06879989088529241, -0.6798239720755932, 0.019223864574277993, -0.5077734636080764, 0.2895377341041748, -0.8815909171772509, 0.26961060734030196, 0.7010681912521721, 0.04617701533217701, -0.7207247242728814, 0.10919768193171712, -0.7163645927780449, 0.11335368336457682, 0.5399257455071469, 0.1069088491769855, 0.6415127763603714, 0.06482289314884246, 0.7230871495835699, 0.1729383757173445, 0.588424034462419, 0.04041969489430071, 0.6922617444936294, 0.09664486015474645, -0.9024347564819717, 0.23754852620304065, 0.6029990116874797, 0.17650228246228067, 0.5616914169613152, 0.047812828544396516, -0.8352106807763419, 0.010849412847984612, -0.9015222669564096, 0.05075509054150789, -0.9212836123063652, 0.14039004190238297, 0.6449197279629556, 0.17461148900154946, 0.9143302742732817, 0.19228435622704435, -0.5028722153697965, 0.2401963718810687, 0.7790097767238359, 0.07702657617898391, 0.6053785383854176, 0.17827720819799833, 0.7556344340646152, 0.24569285880329556, 0.6961472395326095, 0.17567982445477362, -0.9620270853318773, 0.2205885085068445, -0.6220226234982356, 0.029408186385612385, -0.9725005987670876, 0.12380732165372194, -0.9174170741960337, 0.25700100423145894, 0.7480618782285364, 0.029442955108009775, 0.6830774218242524, 0.2597259622890892, 0.551773254387372, 0.2502450281379933, 0.6419231394493641, 0.19784116774481564, -0.7582089732566902, 0.01542068673235395, -0.9715506997687842, 0.15187649691040042, 0.6163795702519348, 0.16092168977082438, -0.5032187377646249, 0.15684093402146973, -0.9118736111675008, 0.2528569382465967, -0.6286280565772031, 0.29156266249261503, 0.9410007696109457, 0.024557380202821444, 0.5728150971311161, 0.19801267140683038, 0.5279711444329218, 0.12947609304879365, 0.7587041420711778, 0.05794437598458082, -0.9570946425161615, 0.10057541890512092, 0.7698753865015779, 0.285298099515484, -0.6223614448350205, 0.13277985534120212, 0.8975165717037994, 0.2844821909217343, 0.8208961050655273, 0.06541071203792542, -0.6245434493166153, 0.2915177175966437, -0.7481610728367967, 0.017071888242969725, -0.7105533581494434, 0.016513032384090225, -0.7520801826782314, 0.09992582488843958, 0.9983074151563498, 0.2271687930391727, -0.7037786161684765, 0.2781387749442969, 0.9044835740385847, 0.06816385716292965, -0.6133172156468265, 0.2901334259742484, 0.6786940350474759, 0.014680692023339383, 0.935525363544691, 0.17884699430979106, -0.9076731849418628, 0.05678584120455168,
0.7372000931862903, 0.2173075320334913, 0.9229495166663709, 0.1115779127334601, 0.8071701586977684, 0.17510681347280024, -0.9458804137396984, 0.013548645024647052, -0.9444360215230644, 0.23503708844928914, 0.6041149276481688, 0.27403581839013447, 0.5514240060196742, 0.15459367624745382, 0.8239136773582152, 0.22458512894915716, -0.5546403716693378, 0.2256571575269214, 0.8415989780043702, 0.029871629633057145, -0.9229557039333918, 0.24338103355299218, -0.7427990187305002, 0.0460116916531303, 0.8732090165661253, 0.19107909305011572, -0.756928462627245, 0.17833029201979697, 0.6659363384973286, 0.08497214709366319, 0.9122517131942713, 0.24321234117715526, 0.7923611502974468, 0.2799271318329707, -0.7608782687058847, 0.17331779645058648, -0.6605108299106265, 0.2779569605966993, -0.8683401397803754, 0.11387921860568602, -0.9036741261186563, 0.1228333422859257, -0.7644058504698642, 0.02507531508977203, -0.9067139104695368, 0.10729050703401868, -0.9637595579240714,
0.10306048476899766, -0.8831054679828898, 0.1724643967205137, 0.8099110511578744, 0.13952749664577568, -0.5934880327739339, 0.12126951241207846, 0.9388942233667705, 0.014779667038314619, -0.9433695874038766, 0.024348468414440917, -0.6150080434632079, 0.11607029308033114, 0.9952792080353441, 0.03143243413480517, -0.8007156143708811, 0.24080052145067848, 0.9661935445527966, 0.2836678993497249, 0.887173131887435, 0.10601714705631719, -0.9526859823664765, 0.10431053622700437, -0.7345368078654139, 0.026004862417360913, 0.520416917416866, 0.054362681278739736, -0.5603273227150112,
0.28175993376229486, 0.5288564614016438, 0.018952073841777793, 0.815312967181136, 0.09305905717748951, -0.5346582141436499, 0.24419714495289657, -0.5756001461147944, 0.24504111497509407, -0.5448601378329931, 0.15357525761493407, -0.7692498503332686, 0.2253964875931678, -0.9239841367132958, 0.03480927409589561, 0.7088131013719823, 0.23006771319214603, -0.8000570966017251, 0.15491354026499826, -0.5144958299138684, 0.06088818427230356, 0.5830752976783772, 0.027152917588717698, -0.6186633941104539, 0.2573735191954759, -0.7611824870134407, 0.1260575568615854, 0.906853198512767, 0.22350308500477062, -0.7591952643141491, 0.2801687126428322, -0.6661629006585992, 0.14287318128540463, -0.7806717522520801, 0.029930970819918447, 0.9501462720504975, 0.04393969153787763, -0.5790811716743313, 0.07478381605682612, -0.6085929508664581, 0.035182333953445846, 0.7881584058742778, 0.2852442322765475, -0.5545608443115906, 0.204912101330499, 0.8001328952728164, 0.1497147779421486, 0.793811845165677, 0.1585722363450228, 0.9713101284760288, 0.1764017498208846, -0.8887558697454699, 0.13909893856954905, 0.5953535492808215, 0.0853093234966309, -0.8959542036128918, 0.25927187866179235, -0.7461766225184663, 0.26872294091489, 0.8834603655685288, 0.24675375721240167, 0.5316761670595502, 0.20389103092152946, 0.7439628001674825, 0.1617018995424212, -0.9039293485693929,
0.07701707739208455, -0.9705893137090598, 0.18220243209782575, -0.9056758754678558, 0.2289749973101582, 0.9581136027062478, 0.23321521089172767, -0.6059997587341479, 0.2629717958947708, 0.8425358652307561, 0.08964820588894974, -0.5015977276066053, 0.178174728149971, -0.5033405814411883, 0.06311399985165986, 0.7253107298131779, 0.11372951784284879, 0.8032359803197091, 0.0401099456513789, 0.7316007459883891, 0.02886220003146947, 0.7793483830336825, 0.17519575591570957, 0.7312515039843517, 0.16299697605868402, -0.8727263985670493, 0.2780775086265562, 0.9023501475295423, 0.2922375678134985, -0.5430573105111793, 0.2347211945316053, 0.5232342691782332, 0.029846177213451737, -0.9662193477444483, 0.2839544024146383, 0.8030075000640935, 0.14260047608118043, -0.9728888312636838, 0.10976857277435655, 0.7348913165382094, 0.2973839174777963, -0.9763854536139348, 0.09132195135345036 };
*/

// функции разные:
// в 70% случаев несущественная квадратичная часть
// в 20 % существенная квадратичная часть
// в 10 % случаев чисто линейная функция
double X_magic[] = {
-1.2413100114046764, 0.11662516854332, 1.3426063544769482, 2.2424237726488125, -1.776542119298939, 0.16950382863121005, -1.6628444267370956, 0.15916166367370002, 0.6049915040522661,
0.1438769472224406, 0.0917453714559513, 0.0, 1.304334671861958, 0.15492800520741376, -0.6451544063366936, 0.21915161184759557, -1.3720129978841142, 0.3360218506096241, -0.7207936943629751, 0.1010388064341537, -1.8035957620767176, 0.16250638558302566, 1.9121058657802346, 0.44627446119547753, -1.8246580769463643, 0.21658297271042645, -1.1808928553836877, 0.0, 1.357746038861125, 0.13298728068573348, -1.2917521403964511, 0.4273788506776153, -1.2396104953836984, 0.4090486360379524, 0.9311669783915159, 0.18030797487358088, 1.820589190192277, 0.0, 0.8255751622854723, 1.7080926471327795, -0.17824887605574058, 0.3537750288296958, -0.9327680355268471, 0.0, 0.7473207506466073, 0.17410637245745597, 1.1714666547415151, 0.12388366951945491, 1.5843439240936266, 1.763667877201074,
-1.0956505753361183, 0.29250453196376563, -0.9833464594085888, 0.30417874034660525, 0.5847792762498092, 1.5577762715280472, -0.794053974866094, 0.33208433068282917, 1.8819883079678676, 0.12541778989965274, 0.9108551394872226, 0.26517621032852867, 1.1549676277559846, 0.2445032310864456, 0.5283106702991813, 0.6115467405350877, -1.985671611124414, 0.46251261567327095, -1.7716580226389838, 0.4863083917308876, -1.3651123984633176, 0.20228735825396532, 1.5023435362244737, 0.114265886389448, -1.0481029023211241, 0.244578573512436, 0.9060268984064725, 0.2428784961063462, -0.2665993135740843, 0.10012691410653184, 0.5937612116420985, 0.24302503808617135, 1.098652169238886, 0.0, -0.7470108914255285, 0.0, -0.8790698004240358, 0.4932980164046675, 0.5314306159633135, 0.3423263843252603, 1.8606806318321722, 0.37817713912593043, 1.6629998589817352, 0.1382754825658828, 0.9296511115246799, 0.11191268213041071, 1.2990894525380023, 1.9083556763469467, 1.7227590749817787, 0.14254572959864925, -1.848052327588606, 0.1084333651252623, 1.3852210577819661, 0.4892224281557255, -0.6223173362531833, 0.35461757352702816, -0.9517922808434696, 1.505153876221863, -0.30528791227239926, 0.15555276015312286, 1.067957489351611, 0.4920648362907746, -1.5585743253822395, 0.3353156353271006, 1.09358073463604, 0.165665268212368, 1.9771982962193717, 0.39637070816332776, -1.309187179228435, 0.33228755330215104, 0.5404945431213417, 0.2646871639899586, 0.3195518145307643, 0.34779163992672346, 0.418411031945467, 0.4422975092303708, 1.9749049003306411, 0.0, 1.7827941325515058, 0.0, 0.7134856715017635, 0.0, -0.7175183942199124, 0.46564609251543865, -0.3553767378734527, 0.20261211304415366, 0.7613041594752558, 1.6384107794724039, 1.2398724337129043, 0.14351125288624705, -1.2749194099948236, 0.4644539952304796, 0.20887262919771032, 0.4190200013811528, -0.9115187113170666, 1.1941100935593998, 0.531954405189842, 0.34634865470101617, 0.848485217213054, 0.14394460349926141, -0.9267281301066694, 1.7452984256411823, 1.5806440047881407, 0.4175875996606102, 1.489057126297008, 1.8131363465999892, -0.6842117240334127, 0.1611415942038933, 0.18028361167188134, 0.4259269494422566, -1.9365448266180414, 0.15815125101712232, 0.7987053800802004, 0.240648767366185, 0.5120534069634753, 0.47171141750094925, -1.2421089789576105, 0.3693008520901526, 1.0697687361936916, 0.10081052905171424, 1.3057599586213702, 0.30772281410679964, 1.0519855258297892, 0.267228027784426, 0.04344372291194132, 0.8418751266410912, 0.3966583222343041, 0.3380024669851337, 1.0132448500386926, 0.25099681693381953, -0.7052120144048029, 1.5795625843843295, -1.957216293654727, 0.47228236801637025, -0.39664131597017493, 0.4437988813312045, -0.031544370337539984, 0.21225787074542818, 1.30117089323676, 2.013115511521737, -1.2887864060909877, 0.34091211896715495, -0.9517322757198483, 0.2795265565779719, 1.4108605941459809, 0.1991347838759749, 1.8641875824956118,
1.9116417991206136, 1.8944971318994763, 0.4266586383106874, -1.9287345536759246, 0.28053336801074424, 0.951461572737375, 0.0, -1.517088325573739, 0.23414573117860035, 1.1753951056372756, 1.286744298053534, 1.4348979764132448, 0.4342657318006372, -1.5537693607771068, 2.536300223571106, -1.7415731207660285, 0.3275944795243032, -1.548741027005943, 0.2403708410205607, 1.2461527737538483, 0.44685324875050314, 0.42471491166739295, 0.0, 1.0519045784054681, 0.4080744676352027, 1.219525093208869, 0.3026425063399799, 0.8339168815175094, 0.3799416199593978, 0.13929639521992643, 0.2366401200072423, -1.5043033703796995, 0.13994900417477601, -1.4145570936858913, 0.167138655479794, 0.9204484215669413, 1.241114697561818, 0.9783110998937178, 0.2436211411797971, 0.8382323339380714, 0.0, -1.7903758065775581, 0.0, 0.7045161253986851, 0.17138842858605843, 0.9154056723505437, 0.0, -0.760047501994404, 1.2639484652731818, -1.5452798328732018, 2.4004412851202126, 0.37567914879859954, 0.13894898485737453, -1.5064637294074026, 0.34050762437739235, -0.07428061889124637, 0.35628646192537416, 0.7089778170030385, 0.4142187103936169, 1.1413616668599789, 1.4940191325125156, 0.4163485444736734, 0.3081991681017165, 0.6162295810863174, 0.2948269835640085, -0.33211644570016974, 0.44349587908145505, 1.1282755956967374, 0.29541211282465213, 1.523969767339393, 0.3003483463417718, 1.1315799772637138, 0.23902421713074873, 1.3599767330158627, 0.0, 0.6589416553463817, 0.46274000553577743, 1.6829881624639411, 0.14768044754392903, -1.0030020766336216, 0.2905676314821277,
-0.4575926347573729, 0.42061080559856867, -0.007682619973409688, 0.3757669014774221, 1.0526054886961744, 0.4948031632634262, 1.5097859086299636, 0.30244287718764046, 0.8857443137207401, 1.6511725039383454, -1.9597392311280732, 0.2943297673291075, 1.0333983386351397, 0.28726927179027284, 1.9605981789309606, 0.2547386075830931, -0.18308791249111556, 0.29484460410568275, 1.911717703255022, 2.505318988666897, 1.3313540505262988, 0.3069411677752849, -1.4631071187748617, 0.20326809541038415, 1.833566612704955, 2.1138484945096465, 1.216976936194707, 1.6930625631021656, 0.6697259630765566, 0.16936339048078863, -1.2343387550443266, 0.0, -1.5662838267465513, 0.0, 1.7973735968766178, 0.19904439032509585, 0.4792937317018424, 0.5301842127102124, 0.6815606714193121, 0.4284465987473257, -1.0589657276209092, 1.9264916168681836, 1.6382412619059383, 0.2577806810641826, 1.8468178226235306, 0.3798783442202368, -0.8821753936019485, 0.23938495299082582, 1.1160348547240877, 1.2861728458984052, 1.459470150912441, 1.5303993385463643, 1.923140001488251, 0.29078893536276296, 0.5490249167951388, 0.41427136124703035, 1.8434029433396801, 0.3623991792016058, 1.6547149935278678, 0.25460351077989984, 1.1284960420024643, 0.3607524010156484, 0.7153773157646385, 0.2256522778550099, 0.8032318850058022, 0.3919423966655853, 0.9692920451861082, 0.315574051664068, -1.1309809055593505, 0.3009888236238403, -1.8209240352631053, 0.2153412596590652, 0.7757183836481016, 0.2928723850704148, 0.81102626405619, 0.366313865732694, 0.5023312489737827, 0.8136382553811385, 0.9632410706878638, 0.17355698986140639, 1.1446001471172087, 1.1499285358960967, 0.08235697151621979, 0.6951653641531333, 0.55126040302321, 0.33373708883731795, 0.721364941548408, 1.0655463745999096, 1.57026682163855, 2.51276213152422, 0.6600965562869939, 0.8175000126558443, -0.7074951039377231, 0.47601473139295003, -1.8269843794890623, 0.1891205826041465, 0.5627014989037702, 0.2945941808296449, -1.7265299939222485, 1.7755665533166214, 1.735131307797385, 0.28986699393380616, -0.42544396334159873, 0.37675567884199135, 0.7921921240256588, 0.4085586406751135, 1.0475041937022367, 1.2031951481456824, -0.6333513330923637, 0.46124374932386014, 1.4029411871151936, 0.1693740398211725, 1.999932900477507, 0.4879165063471341, 1.0941028114436215, 0.4024238934013936, 1.2137258190407987, 0.15215375408267243, 1.6229990073709213, 0.47663633643478465, 1.0807314245658888, 0.45989239030069995, 1.599294883426422, 0.3306514236190797, -0.6950500694500199, 0.3877352780070642, 0.04364268187789788, 0.0, 1.2202285035401546, 0.22882829388131884, 1.5038534105519306, 0.0, -0.447989167327024, 0.22343999301343265, 1.907927064625036, 0.2264330176176561, -0.22908902593157565, 0.19676387156385655, -1.8672475543158236, 0.14864812224211846, -0.12740326626306064, 0.25741582062846585, 0.6889828244001175, 0.4785538964207606, 1.3308065860445275, 1.7648898841178409, 1.7100099192404499, 0.24872305451599824, -0.5112005638712915, 0.45730029142289796, -1.6446776718247207, 2.183830339096145, 1.4861468191444887, 0.10592205652308771, 0.9621414819361394, 0.3714439878211703, -1.579571468898673, 0.1851696854906277, -0.44169140122316786, 0.2528535589733908, -0.11271759974005224, 0.36244722205336255, 1.348791977576875, 0.49272555021830267, -0.41911102091678254, 0.6719487828681504, 0.881374097461719, 0.1774328602355662, 0.29960389143339006, 0.4012201396977889, -1.2111462660016066, 0.10652999105262216, -1.6123385592996597, 0.0, -1.8330093363055646, 0.2230392644177436,
-0.41806557215543716, 0.0, 1.8769698086314313, 0.242681880157419, 1.3049198921062346, 1.8802103672561015, 0.4518623236931574, 1.0862068875854876, -1.1277012837883975, 0.22830512386632396, 0.8647785820306453, 0.45241375244578175, 0.33565471137756875, 0.22182177717637416, 1.5756906793236463, 0.4830171919419538, 0.13723980981725337, 0.1928812787570765, -0.3694586144715799, 0.13099710340571127, -0.9240888513061507, 0.3059669454026892, 1.653920968198215, 0.43447109690257524, -1.7812743064110435, 0.3175251530149258, -0.4478841480890159, 0.0, -0.39327366446753187, 0.9776935463240266, 1.9458112373740462, 0.45379890910873655, 1.4699955318725615, 0.4273832679172658, -1.8899932035246596, 0.1144950024806938, 1.5366089694107927, 0.4103625884653279, 1.576301746990478, 0.20519521816843322, -1.984735345778517, 0.11182460939236259, 1.6336403029497377, 0.401191383944696, -1.709182896740738, 0.23429912098442973, -0.8126322481203268, 0.3533754481137411, 0.5681476979773439, 1.1869595209478747, -0.5543641534474197, 0.2585519857222691, 1.5447136722979926, 1.9912293992189434, -0.011870601225828281, 0.4108331810215071, -1.4638778789135292, 0.19713118053207898, 1.8952654362512114, 0.23122965031543094, -0.1265206052874963, 0.9719178959489296, 0.8459635112809413, 0.1152739506483683, -0.2852487776620847, 0.0, -0.5006683705228203, 0.253958651235635, -0.036490500713783014, 0.46646646761559285, -0.5673890434842535, 0.34461326360226613, -1.5084280662351308, 0.2314554912010628, -1.6117273524717637, 1.7235981775668612, -1.9833167222010366, 0.31637763171871935,
1.9270141511938192, 0.0, 0.28928307099422, 0.2022718874053997, -1.8896271803663778, 0.2963786851341799, 1.4674998556568846, 0.24437244840314257, 1.3304133051693463, 0.3160178791273055, 1.2958489331757985, 0.4388816841978168, 0.7393952567700821, 0.3627393803219423, 0.006423656920903298, 0.48485628910637213, -0.08138214416848277, 0.1335748811539503, 1.1736029234325696, 0.3035416628500993, 1.779323545327674, 0.49596903816179694, 1.8401617914723805, 0.3522286138629077, -1.4094658602999783, 1.7739299720258637, 0.8160775619544391, 0.3360661458776443, -1.351517293159323, 0.45634289922084925, 1.6019108293071942, 0.4981839707958827, 0.42485094695355086, 0.0, 0.9601105669356638, 0.3290106151738518, -0.8860909798859868, 1.7870093358597885, 1.0497798220137262, 0.0, 1.5940788477394987, 0.25323413504781966, -0.49296346841234273, 0.19249753245402168, 0.8310924548459326, 1.8271003766662737, -0.34506387001792316, 0.5996945375554866, -0.3046385405201564, 0.44312539608765045, -0.5574432595004422, 0.6994859694376977, -1.9139166453455083, 0.27144783101129144, 0.6018208725521084, 0.47906840374961646, 1.7488873994094043, 0.24596124303744912, 0.7045997060280456, 0.8907468770193453, 1.4864208717498122, 0.15975493068139085, 1.5930381948749042, 0.33305668791660215, 1.6962095998401052, 0.1470378181436901, 1.5123686245102606, 0.11090104029383366, 1.5023427464143027, 0.265153778912495, 1.7758097004904316, 0.2006631685671721, -0.9145834633309462, 0.3312360940620037, -0.17514205920514936, 0.8021937686594433, 0.5083341941049107, 1.3011703943081718, 1.9879321631690166, 0.1440647334467748, 1.6249992168321887, 0.49708554124528337, -1.3832874914154984, 0.3878605182420606, -0.24828464528331073, 0.3857713733658755, 1.399950889472994, 2.034258740907092, -1.1130554460945428, 0.4307073968552375, -0.47945644339081417, 0.0, 0.6297423373768037, 0.4589395176453802, -1.3032325767269906, 0.15648044440306352, 1.8032228657773501, 0.24684598323520046, 0.683761058756038, 0.1390503793115818, 0.42265870477421696, 0.41970043997079753, -0.884188205835442, 0.49648340129280144, -1.5834203890586742, 0.309083686095347, 1.8539346886696326, 2.705237415353591, -1.235858767487532, 0.1256136960148862, -1.3078355540057258, 0.0, -1.6044782302066256, 0.2553201257163642, -1.2879537633100795, 1.6495161738157096, 1.1620741305087163, 0.47118084260616866, 1.2879125604245825, 2.2201594043514286, 1.9740002542988815, 0.1133012784092947, -1.7815664107254907, 0.4184241977872024, -0.8624649049962123, 0.45901300457225647, 0.6644273956554078, 0.4308172948780634, 0.5729776693828297, 0.11514312816817762, -1.04728497835295, 0.10826245684138308, -0.27533696745730696, 0.4427532005250109, 1.6140201878095555, 0.18755165487689462, -1.8293337551727322, 0.0, 1.089304304562695, 0.36632401497796974, 0.5882679962607739, 0.0, -0.2660096400013354, 0.2949191404678389, 0.1786663898958003, 0.4122059955095797, 0.8151601101604188, 1.6032040454500116, 1.585817717646411, 2.1496281521603384, 1.7402714734786895, 0.24596824914718624, 1.437429726133673, 0.3902669303694215, -0.5884676174188579, 1.0921494429951952, 1.7150177266874471, 2.5408921804651854,
1.8414666651093579, 2.2660692849518433, -0.5679082755077283, 0.378964914207053, 1.213435457913325, 0.41790918935805443, 1.7342945188271859, 0.13075222516931226, 1.7423188635824234, 2.200341116314659, -1.7844218818750166, 1.9028583759609718, -1.5459770140455649, 0.13371182109231539, 1.310963146730341, 1.9256800649855443, 0.8597138362759187, 0.4535549248469931, 0.9399688226234973, 0.36411186380572425, 1.3923929394582961, 0.2957193504520992, -0.5749490389375171, 0.36506699330141257, 0.7194656806792004, 0.4943624573122537, -1.6948039198199518, 0.0, -1.6765508746133255, 0.20709649498142416
};


double minVal = 0.0;
// ------------------------------------------------------------------------------------------------
X2Problem::X2Problem()
{
  mDimension = 1;
  mIsInitialized = false;
  function_number = 1;
  mLeftBorder = -2.2;
  mRightBorder = 1.8;

}

// ------------------------------------------------------------------------------------------------
int X2Problem::SetDimension(int dimension)
{
  if (dimension > 0 && dimension <= mMaxDimension)
  {
    mDimension = dimension;
    return IGlobalOptimizationProblem::PROBLEM_OK;
  }
  else
    return IGlobalOptimizationProblem::PROBLEM_ERROR;
}

// ------------------------------------------------------------------------------------------------
int X2Problem::GetDimension() const
{
  return mDimension;
}

// ------------------------------------------------------------------------------------------------
int X2Problem::Initialize()
{
  if (mDimension > 0)
  {
    mIsInitialized = true;
    return IGlobalOptimizationProblem::PROBLEM_OK;
  }
  else
    return IGlobalOptimizationProblem::PROBLEM_ERROR;
}

// ------------------------------------------------------------------------------------------------
void X2Problem::GetBounds(std::vector<double>& lower, std::vector<double>& upper)
{
  lower.resize(mDimension);
  upper.resize(mDimension);
  for (int i = 0; i < mDimension; i++)
  {
    lower[i] = mLeftBorder;
    upper[i] = mRightBorder;
  }
}

// ------------------------------------------------------------------------------------------------
int X2Problem::GetOptimumValue(double& value) const
{
  value = 0.0;
  int fn = function_number;
  for (int j = 0; j < mDimension; j++)
    if (X_magic[(fn - 1) * mDimension * 2 + j * 2 + 1] != 0)
      value += -X_magic[(fn - 1) * mDimension * 2 + j * 2 + 0] * X_magic[(fn - 1) * mDimension * 2 + j * 2 + 0]
      / (4.0 * X_magic[(fn - 1) * mDimension * 2 + j * 2 + 1]);
    else
      if (X_magic[(fn - 1) * mDimension * 2 + j * 2 + 0] > 0)
        value += X_magic[(fn - 1) * mDimension * 2 + j * 2 + 0] * mLeftBorder;
      else
        value += X_magic[(fn - 1) * mDimension * 2 + j * 2 + 0] * mRightBorder;

  return IGlobalOptimizationProblem::PROBLEM_OK;
}

// ------------------------------------------------------------------------------------------------
int X2Problem::GetOptimumPoint(std::vector<double>& point, std::vector<std::string>& u) const
{

  double min_ = 0.0;

  point.resize(mDimension);

  for (int i = 0; i < mDimension; i++) 
  {

    if (X_magic[(function_number - 1) * mDimension * 2 + i * 2 + 1] == 0) 
    {
      if (X_magic[(function_number - 1) * mDimension * 2 + i * 2 + 0] > 0) 
      {
        min_ = mLeftBorder;
      }
      else 
      {
        min_ = mRightBorder;
      }
      point[i] = min_;
    }
    else {
      min_ = -X_magic[(function_number - 1) * mDimension * 2 + i * 2 + 0]
        / (2 * X_magic[(function_number - 1) * mDimension * 2 + i * 2 + 1]);
      if (min_ < mLeftBorder)
        point[i] = mLeftBorder;
      else if (min_ > mRightBorder)
        point[i] = mRightBorder;
      else
        point[i] = min_;
    }
  }
  return IGlobalOptimizationProblem::PROBLEM_OK;
}

// ------------------------------------------------------------------------------------------------
int X2Problem::GetNumberOfFunctions() const
{
  return 1;
}

// ------------------------------------------------------------------------------------------------
int X2Problem::GetNumberOfConstraints() const
{
  return 0;
}

// ------------------------------------------------------------------------------------------------
int X2Problem::GetNumberOfCriterions() const
{
  return 1;
}


// ------------------------------------------------------------------------------------------------
double X2Problem::CalculateFunctionals(const std::vector<double>& x, std::vector<std::string>& u, int fNumber)
{
  double sum = 0.;
  int fn = function_number;
  for (int j = 0; j < mDimension; j++)
    sum += X_magic[(fn - 1) * mDimension * 2 + j * 2 + 0] * (x[j])
    + X_magic[(fn - 1) * mDimension * 2 + j * 2 + 1] * x[j] * x[j];

  return sum;
}

// ------------------------------------------------------------------------------------------------
X2Problem::~X2Problem()
{

}

// ------------------------------------------------------------------------------------------------
LIB_EXPORT_API IGlobalOptimizationProblem* create()
{
  return new X2Problem();
}

// ------------------------------------------------------------------------------------------------
LIB_EXPORT_API void destroy(IGlobalOptimizationProblem* ptr)
{
  delete ptr;
}
// - end of file ----------------------------------------------------------------------------------
